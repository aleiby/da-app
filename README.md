# Digital Arcana
<img src="img/thumbnail.png" width="175">

**Working prototype:**

https://digitalarcana.xyz/ (raise or lower piano top to adjust volume)

**Presentation video:**

[![Digital Arcana Encode x Tezos Hackathon (Extended)](img/davideo.png)](https://youtu.be/XqrJaPFfyTg "Digital Arcana Encode x Tezos Hackathon (Extended)
")

## Getting Started

**New contributors and AI agents**: Run the bootstrap script to set up your development environment:

```bash
npm run bootstrap
```

This will check prerequisites, install dependencies, start Redis, set up configuration templates, and verify the setup with type checking and tests.

For more detailed guides:
- **[Quick Start Guide](QUICKSTART.md)** - Get up and running in under 10 minutes
- **[Complete Setup Documentation](SETUP.md)** - Detailed installation and configuration guide
- **[Architecture & Development Guide](CLAUDE.md)** - For AI agents and developers

### Alternative: Docker Compose

For a containerized development environment with Redis and MongoDB:

```bash
# Start Redis and MongoDB services
docker compose up -d redis mongodb

# Then run the app locally
npm install
npm run server-dev
```

Or run everything in containers:

```bash
docker compose --profile full up
```

### Verifying Your Setup

After bootstrap, verify your environment is correctly configured:

```bash
npm run check-setup
```

This checks Node.js version, Redis connectivity, MongoDB configuration, and required config files.

### Automatic Node Version Switching

This project uses `.nvmrc` to specify the required Node.js version. Configure your shell to automatically switch versions when entering the project directory:

**nvm (Node Version Manager)**

Add to your `~/.bashrc`, `~/.zshrc`, or equivalent:

```bash
# Automatic nvm use when entering a directory with .nvmrc
autoload -U add-zsh-hook
load-nvmrc() {
  local nvmrc_path="$(nvm_find_nvmrc)"
  if [ -n "$nvmrc_path" ]; then
    local nvmrc_node_version=$(nvm version "$(cat "${nvmrc_path}")")
    if [ "$nvmrc_node_version" = "N/A" ]; then
      nvm install
    elif [ "$nvmrc_node_version" != "$(nvm version)" ]; then
      nvm use
    fi
  fi
}
add-zsh-hook chpwd load-nvmrc
load-nvmrc
```

**fnm (Fast Node Manager)**

fnm has built-in support. Add to your shell config:

```bash
eval "$(fnm env --use-on-cd)"
```

## Introduction

Digital Arcana is a platform born from the love of tarot art and a desire to utilize it in games.  Providing distraction in turbulent times, teaching rule-based learning principles, and fostering competition in a structured environment are just a few of the great aspects of games.  They even channel conflict in constructive directions and foster creativity.

Today, NFTs are largely focused on one of two avenues, the purely aesthetic or those bound to a particular game or function. Our goal is to merge the two into one. Art alone has intrinsic value and we aim to provide it utility as well by integrating it seamlessly across all games on a unified platform.

Players collect art as cards through acquiring presorted packs. The cards are used for gameplay while at the same time contributing to a player's curated collection. We will work with artists to create and distribute their art as new sets to the community through the platform.

The experience aims to be as diverse as real-world card games, with classic games, experiences generated by the DA team, and content from the community.

### Monetization & Supply

Digital Arcana is an avenue for artists to share their art, but without that art there would be no inspiration for the platform. Because of this, DA's smart contracts provide royalties of all purchases back to artists who mint their decks on the platform.

Art will initially be distributed in packs of seven cards. Cards are minted in multiple lots of differing sizes, thus providing rarity to cards of smaller lots. Packs are sold at random, or optionally with guarantees of including a card of specific rarity for a premium. Games may additionally use a card's assocated rarity for special purposes (e.g. breaking ties in a game of War).

Because each card is an NFT, you own them, and can resell them on marketplaces such as [objkt.com](http://objkt.com). In the future, we will enable user currated packs which can be resold as a set.

Digital Arcana is built on [Tezos](https://tezos.com/). This keeps transaction fees low, and the environment happy.

We hope you enjoy DA as much as we do making it!

### Contracts

The smart contracts are written in SmartPy and compile to Michelson for deployment on Tezos.

#### Current Testnet: Ghostnet

Contracts need to be deployed to Ghostnet. See [SETUP.md](SETUP.md#deploying-smart-contracts) for deployment instructions.

- Block Explorer: https://ghostnet.tzkt.io/
- Faucet: https://faucet.ghostnet.teztnets.com/

#### FA2 (NFT Token Contract)
- SmartPy source: [python/contracts/fa2.py](python/contracts/fa2.py)
- Standard: [TZIP-12 FA2](https://gitlab.com/tzip/tzip/-/blob/master/proposals/tzip-12/)

#### Escrow/Marketplace Contract
- SmartPy source: [python/contracts/escrow.py](python/contracts/escrow.py)
- Handles pack purchases with atomic NFT transfers

#### Legacy Deployments (Deprecated Networks)
Previous testnet deployments (for reference only - these networks are no longer active):
- Hangzhounet FA2: KT1N1a7TA1rEedQo2pEQXhuVgSQNvgRWKkdJ
- Ithacanet FA2: KT1FhGBLyxPTnAiU41GPTPR1FzKGVajgKrme

To avoid revealing cards before they are purchased, we use an escrow contract. Users can add and remove funds, which can be redeemed for card packs. A future implementation might use [tickets](python/contracts/tickets.py) which would allow purchased, unopened packs to be traded, resold, or gifted. Opening a card pack consists of redeeming the escrowed funds and transferring the set of cards to the user in a single atomic transaction on the Tezos network.  This operation is initated by the server at the user's request, and signed by an administration account with operator permission to perform the transaction.  Choosing the set of cards is up to the server, selecting randomly from the available, pre-sorted packs.  This provides the freedom to enable special sales (e.g. guaranteeing a card of a specific rarity), and prevents the set of cards from being exposed before funds have been commited by the purchaser.

<img src="img/contracts.png" width="332">
